Codes are copied and adapted from https://github.com/FoundationVision/LlamaGen.
