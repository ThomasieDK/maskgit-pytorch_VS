Codes are copied and adapted from https://github.com/bytedance/1d-tokenizer.
